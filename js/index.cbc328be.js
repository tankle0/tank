import{x as oe,o as It,a as ne,s as ae,l as Lt,u as se,r as Mt,c as le,w as ce,b as Ft,d as xt}from"./vendor.b3ccea3b.js";import{_ as Nt}from"./index.d2567b85.js";function Ct(n){return n===""?n:n==="true"||n=="1"}function ue(n,e){return new Promise((t,r)=>{var i=new XMLHttpRequest;i.responseType="blob",i.onload=function(){var o=new FileReader;o.onloadend=function(){t(o.result)},o.readAsArrayBuffer(i.response)},i.open("GET",n),i.send()})}var rt=function(n,e){return Object.assign(document.createElement("canvas"),{width:n,height:e})},Ot={},at={};Object.defineProperty(at,"__esModule",{value:!0});at.loop=at.conditional=Rt=at.parse=void 0;var he=function n(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r;if(Array.isArray(t))t.forEach(function(a){return n(e,a,r,i)});else if(typeof t=="function")t(e,r,i,n);else{var o=Object.keys(t)[0];Array.isArray(t[o])?(i[o]={},n(e,t[o],r,i[o])):i[o]=t[o](e,r,i,n)}return r},Rt=at.parse=he,fe=function(e,t){return function(r,i,o,a){t(r,i,o)&&a(r,e,i,o)}};at.conditional=fe;var de=function(e,t){return function(r,i,o,a){for(var c=[],l=r.pos;t(r,i,o);){var h={};if(a(r,e,i,h),r.pos===l)break;l=r.pos,c.push(h)}return c}};at.loop=de;var j={};Object.defineProperty(j,"__esModule",{value:!0});j.readBits=j.readArray=j.readUnsigned=j.readString=j.peekBytes=j.readBytes=j.peekByte=j.readByte=Gt=j.buildStream=void 0;var ge=function(e){return{data:e,pos:0}},Gt=j.buildStream=ge,Ut=function(){return function(e){return e.data[e.pos++]}};j.readByte=Ut;var pe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(t){return t.data[t.pos+e]}};j.peekByte=pe;var pt=function(e){return function(t){return t.data.subarray(t.pos,t.pos+=e)}};j.readBytes=pt;var ve=function(e){return function(t){return t.data.subarray(t.pos,t.pos+e)}};j.peekBytes=ve;var me=function(e){return function(t){return Array.from(pt(e)(t)).map(function(r){return String.fromCharCode(r)}).join("")}};j.readString=me;var ye=function(e){return function(t){var r=pt(2)(t);return e?(r[1]<<8)+r[0]:(r[0]<<8)+r[1]}};j.readUnsigned=ye;var be=function(e,t){return function(r,i,o){for(var a=typeof t=="function"?t(r,i,o):t,c=pt(e),l=new Array(a),h=0;h<a;h++)l[h]=c(r);return l}};j.readArray=be;var we=function(e,t,r){for(var i=0,o=0;o<r;o++)i+=e[t+o]&&Math.pow(2,r-o-1);return i},Be=function(e){return function(t){for(var r=Ut()(t),i=new Array(8),o=0;o<8;o++)i[7-o]=!!(r&1<<o);return Object.keys(e).reduce(function(a,c){var l=e[c];return l.length?a[c]=we(i,l.index,l.length):a[c]=i[l.index],a},{})}};j.readBits=Be;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=at,t=j,r={blocks:function(f){for(var D=0,k=[],S=f.data.length,U=0,d=(0,t.readByte)()(f);d!==D&&d;d=(0,t.readByte)()(f)){if(f.pos+d>=S){var p=S-f.pos;k.push((0,t.readBytes)(p)(f)),U+=p;break}k.push((0,t.readBytes)(d)(f)),U+=d}for(var B=new Uint8Array(U),u=0,w=0;w<k.length;w++)B.set(k[w],u),u+=k[w].length;return B}},i=(0,e.conditional)({gce:[{codes:(0,t.readBytes)(2)},{byteSize:(0,t.readByte)()},{extras:(0,t.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,t.readUnsigned)(!0)},{transparentColorIndex:(0,t.readByte)()},{terminator:(0,t.readByte)()}]},function(g){var f=(0,t.peekBytes)(2)(g);return f[0]===33&&f[1]===249}),o=(0,e.conditional)({image:[{code:(0,t.readByte)()},{descriptor:[{left:(0,t.readUnsigned)(!0)},{top:(0,t.readUnsigned)(!0)},{width:(0,t.readUnsigned)(!0)},{height:(0,t.readUnsigned)(!0)},{lct:(0,t.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,e.conditional)({lct:(0,t.readArray)(3,function(g,f,D){return Math.pow(2,D.descriptor.lct.size+1)})},function(g,f,D){return D.descriptor.lct.exists}),{data:[{minCodeSize:(0,t.readByte)()},r]}]},function(g){return(0,t.peekByte)()(g)===44}),a=(0,e.conditional)({text:[{codes:(0,t.readBytes)(2)},{blockSize:(0,t.readByte)()},{preData:function(f,D,k){return(0,t.readBytes)(k.text.blockSize)(f)}},r]},function(g){var f=(0,t.peekBytes)(2)(g);return f[0]===33&&f[1]===1}),c=(0,e.conditional)({application:[{codes:(0,t.readBytes)(2)},{blockSize:(0,t.readByte)()},{id:function(f,D,k){return(0,t.readString)(k.blockSize)(f)}},r]},function(g){var f=(0,t.peekBytes)(2)(g);return f[0]===33&&f[1]===255}),l=(0,e.conditional)({comment:[{codes:(0,t.readBytes)(2)},r]},function(g){var f=(0,t.peekBytes)(2)(g);return f[0]===33&&f[1]===254}),h=[{header:[{signature:(0,t.readString)(3)},{version:(0,t.readString)(3)}]},{lsd:[{width:(0,t.readUnsigned)(!0)},{height:(0,t.readUnsigned)(!0)},{gct:(0,t.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,t.readByte)()},{pixelAspectRatio:(0,t.readByte)()}]},(0,e.conditional)({gct:(0,t.readArray)(3,function(g,f){return Math.pow(2,f.lsd.gct.size+1)})},function(g,f){return f.lsd.gct.exists}),{frames:(0,e.loop)([i,c,l,o,a],function(g){var f=(0,t.peekByte)()(g);return f===33||f===44})}],m=h;n.default=m})(Ot);var xe=oe(Ot);const Ce=(n,e)=>{const t=new Array(n.length),r=n.length/e,i=function(m,g){const f=n.slice(g*e,(g+1)*e);t.splice.apply(t,[m*e,e].concat(f))},o=[0,4,2,1],a=[8,8,4,2];for(var c=0,l=0;l<4;l++)for(var h=o[l];h<r;h+=a[l])i(h,c),c++;return t},Pe=(n,e,t)=>{const r=4096,i=-1,o=t;var a,c,l,h,m,g,f,D,k,S,U,d,p,B,u,w;const y=new Array(t),C=new Array(r),x=new Array(r),T=new Array(r+1);for(d=n,c=1<<d,m=c+1,a=c+2,f=i,h=d+1,l=(1<<h)-1,k=0;k<c;k++)C[k]=0,x[k]=k;var U,D,p,B,w,u;for(U=D=p=B=w=u=0,S=0;S<o;){if(B===0){if(D<h){U+=e[u]<<D,D+=8,u++;continue}if(k=U&l,U>>=h,D-=h,k>a||k==m)break;if(k==c){h=d+1,l=(1<<h)-1,a=c+2,f=i;continue}if(f==i){T[B++]=x[k],f=k,p=k;continue}for(g=k,k==a&&(T[B++]=p,k=f);k>c;)T[B++]=x[k],k=C[k];p=x[k]&255,T[B++]=p,a<r&&(C[a]=f,x[a]=p,a++,(a&l)==0&&a<r&&(h++,l+=a)),f=g}B--,y[w++]=T[B],S++}for(S=w;S<o;S++)y[S]=0;return y},ke=n=>{const e=new Uint8Array(n);return Rt(Gt(e),xe)},_e=n=>{const e=n.pixels.length,t=new Uint8ClampedArray(e*4);for(var r=0;r<e;r++){const i=r*4,o=n.pixels[r],a=n.colorTable[o];t[i]=a[0],t[i+1]=a[1],t[i+2]=a[2],t[i+3]=o!==n.transparentIndex?255:0}return t},Te=(n,e,t)=>{if(!n.image){console.warn("gif frame does not have associated image.");return}const{image:r}=n,i=r.descriptor.width*r.descriptor.height;var o=Pe(r.data.minCodeSize,r.data.blocks,i);r.descriptor.lct.interlaced&&(o=Ce(o,r.descriptor.width));const a={pixels:o,dims:{top:n.image.descriptor.top,left:n.image.descriptor.left,width:n.image.descriptor.width,height:n.image.descriptor.height}};return r.descriptor.lct&&r.descriptor.lct.exists?a.colorTable=r.lct:a.colorTable=e,n.gce&&(a.delay=(n.gce.delay||10)*10,a.disposalType=n.gce.extras.disposal,n.gce.extras.transparentColorGiven&&(a.transparentIndex=n.gce.transparentColorIndex)),t&&(a.patch=_e(a)),a},De=(n,e)=>n.frames.filter(t=>t.image).map(t=>Te(t,n.gct,e));function Ae(n,e,t){const r=$t(e),i=n-1;let o=0;switch(t){case V.L:o=et[i][0];break;case V.M:o=et[i][1];break;case V.Q:o=et[i][2];break;case V.H:o=et[i][3];break}return r<=o}function Ee(n,e){for(var t=1,r=$t(n),i=0,o=et.length;i<o;i++){var a=0;switch(e){case V.L:a=et[i][0];break;case V.M:a=et[i][1];break;case V.Q:a=et[i][2];break;case V.H:a=et[i][3];break}if(r<=a)break;t++}if(t>et.length)throw new Error("Too long data");return t}function $t(n){var e=encodeURI(n).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=Number(n)?3:0)}class Se{constructor(e){this.mode=Z.MODE_8BIT_BYTE,this.parsedData=[],this.data=e;const t=[];for(let r=0,i=this.data.length;r<i;r++){const o=[],a=this.data.charCodeAt(r);a>65536?(o[0]=240|(a&1835008)>>>18,o[1]=128|(a&258048)>>>12,o[2]=128|(a&4032)>>>6,o[3]=128|a&63):a>2048?(o[0]=224|(a&61440)>>>12,o[1]=128|(a&4032)>>>6,o[2]=128|a&63):a>128?(o[0]=192|(a&1984)>>>6,o[1]=128|a&63):o[0]=a,t.push(o)}this.parsedData=Array.prototype.concat.apply([],t),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}getLength(){return this.parsedData.length}write(e){for(let t=0,r=this.parsedData.length;t<r;t++)e.put(this.parsedData[t],8)}}class st{constructor(e=-1,t=V.L){this.moduleCount=0,this.dataList=[],this.typeNumber=e,this.errorCorrectLevel=t,this.moduleCount=0,this.dataList=[]}addData(e){if(this.typeNumber<=0)this.typeNumber=Ee(e,this.errorCorrectLevel);else{if(this.typeNumber>40)throw new Error(`Invalid QR version: ${this.typeNumber}`);if(!Ae(this.typeNumber,e,this.errorCorrectLevel))throw new Error(`Data is too long for QR version: ${this.typeNumber}`)}const t=new Se(e);this.dataList.push(t),this.dataCache=void 0}isDark(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw new Error(`${e},${t}`);return this.modules[e][t]}getModuleCount(){return this.moduleCount}make(){this.makeImpl(!1,this.getBestMaskPattern())}makeImpl(e,t){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(let r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(let i=0;i<this.moduleCount;i++)this.modules[r][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,t),this.typeNumber>=7&&this.setupTypeNumber(e),this.dataCache==null&&(this.dataCache=st.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,t)}setupPositionProbePattern(e,t){for(let r=-1;r<=7;r++)if(!(e+r<=-1||this.moduleCount<=e+r))for(let i=-1;i<=7;i++)t+i<=-1||this.moduleCount<=t+i||(0<=r&&r<=6&&(i==0||i==6)||0<=i&&i<=6&&(r==0||r==6)||2<=r&&r<=4&&2<=i&&i<=4?this.modules[e+r][t+i]=!0:this.modules[e+r][t+i]=!1)}getBestMaskPattern(){if(Number.isInteger(this.maskPattern)&&Object.values(it).includes(this.maskPattern))return this.maskPattern;let e=0,t=0;for(let r=0;r<8;r++){this.makeImpl(!0,r);const i=L.getLostPoint(this);(r==0||e>i)&&(e=i,t=r)}return t}setupTimingPattern(){for(let e=8;e<this.moduleCount-8;e++)this.modules[e][6]==null&&(this.modules[e][6]=e%2==0);for(let e=8;e<this.moduleCount-8;e++)this.modules[6][e]==null&&(this.modules[6][e]=e%2==0)}setupPositionAdjustPattern(){const e=L.getPatternPosition(this.typeNumber);for(let t=0;t<e.length;t++)for(let r=0;r<e.length;r++){const i=e[t],o=e[r];if(this.modules[i][o]==null)for(let a=-2;a<=2;a++)for(let c=-2;c<=2;c++)a==-2||a==2||c==-2||c==2||a==0&&c==0?this.modules[i+a][o+c]=!0:this.modules[i+a][o+c]=!1}}setupTypeNumber(e){const t=L.getBCHTypeNumber(this.typeNumber);for(var r=0;r<18;r++){var i=!e&&(t>>r&1)==1;this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=i}for(var r=0;r<18;r++){var i=!e&&(t>>r&1)==1;this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=i}}setupTypeInfo(e,t){const r=this.errorCorrectLevel<<3|t,i=L.getBCHTypeInfo(r);for(var o=0;o<15;o++){var a=!e&&(i>>o&1)==1;o<6?this.modules[o][8]=a:o<8?this.modules[o+1][8]=a:this.modules[this.moduleCount-15+o][8]=a}for(var o=0;o<15;o++){var a=!e&&(i>>o&1)==1;o<8?this.modules[8][this.moduleCount-o-1]=a:o<9?this.modules[8][15-o-1+1]=a:this.modules[8][15-o-1]=a}this.modules[this.moduleCount-8][8]=!e}mapData(e,t){let r=-1,i=this.moduleCount-1,o=7,a=0;for(let c=this.moduleCount-1;c>0;c-=2)for(c==6&&c--;;){for(let l=0;l<2;l++)if(this.modules[i][c-l]==null){let h=!1;a<e.length&&(h=(e[a]>>>o&1)==1),L.getMask(t,i,c-l)&&(h=!h),this.modules[i][c-l]=h,o--,o==-1&&(a++,o=7)}if(i+=r,i<0||this.moduleCount<=i){i-=r,r=-r;break}}}static createData(e,t,r){const i=ot.getRSBlocks(e,t),o=new Ie;for(var a=0;a<r.length;a++){const l=r[a];o.put(l.mode,4),o.put(l.getLength(),L.getLengthInBits(l.mode,e)),l.write(o)}let c=0;for(var a=0;a<i.length;a++)c+=i[a].dataCount;if(o.getLengthInBits()>c*8)throw new Error(`code length overflow. (${o.getLengthInBits()}>${c*8})`);for(o.getLengthInBits()+4<=c*8&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(!1);for(;!(o.getLengthInBits()>=c*8||(o.put(st.PAD0,8),o.getLengthInBits()>=c*8));)o.put(st.PAD1,8);return st.createBytes(o,i)}static createBytes(e,t){let r=0,i=0,o=0;const a=new Array(t.length),c=new Array(t.length);for(var l=0;l<t.length;l++){const D=t[l].dataCount,k=t[l].totalCount-D;i=Math.max(i,D),o=Math.max(o,k),a[l]=new Array(D);for(var h=0;h<a[l].length;h++)a[l][h]=255&e.buffer[h+r];r+=D;const S=L.getErrorCorrectPolynomial(k),d=new ut(a[l],S.getLength()-1).mod(S);c[l]=new Array(S.getLength()-1);for(var h=0;h<c[l].length;h++){const B=h+d.getLength()-c[l].length;c[l][h]=B>=0?d.get(B):0}}let m=0;for(var h=0;h<t.length;h++)m+=t[h].totalCount;const g=new Array(m);let f=0;for(var h=0;h<i;h++)for(var l=0;l<t.length;l++)h<a[l].length&&(g[f++]=a[l][h]);for(var h=0;h<o;h++)for(var l=0;l<t.length;l++)h<c[l].length&&(g[f++]=c[l][h]);return g}}st.PAD0=236;st.PAD1=17;const V={L:1,M:0,Q:3,H:2},Z={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3},it={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};class L{static getBCHTypeInfo(e){let t=e<<10;for(;L.getBCHDigit(t)-L.getBCHDigit(L.G15)>=0;)t^=L.G15<<L.getBCHDigit(t)-L.getBCHDigit(L.G15);return(e<<10|t)^L.G15_MASK}static getBCHTypeNumber(e){let t=e<<12;for(;L.getBCHDigit(t)-L.getBCHDigit(L.G18)>=0;)t^=L.G18<<L.getBCHDigit(t)-L.getBCHDigit(L.G18);return e<<12|t}static getBCHDigit(e){let t=0;for(;e!=0;)t++,e>>>=1;return t}static getPatternPosition(e){return L.PATTERN_POSITION_TABLE[e-1]}static getMask(e,t,r){switch(e){case it.PATTERN000:return(t+r)%2==0;case it.PATTERN001:return t%2==0;case it.PATTERN010:return r%3==0;case it.PATTERN011:return(t+r)%3==0;case it.PATTERN100:return(Math.floor(t/2)+Math.floor(r/3))%2==0;case it.PATTERN101:return t*r%2+t*r%3==0;case it.PATTERN110:return(t*r%2+t*r%3)%2==0;case it.PATTERN111:return(t*r%3+(t+r)%2)%2==0;default:throw new Error(`bad maskPattern:${e}`)}}static getErrorCorrectPolynomial(e){let t=new ut([1],0);for(let r=0;r<e;r++)t=t.multiply(new ut([1,H.gexp(r)],0));return t}static getLengthInBits(e,t){if(1<=t&&t<10)switch(e){case Z.MODE_NUMBER:return 10;case Z.MODE_ALPHA_NUM:return 9;case Z.MODE_8BIT_BYTE:return 8;case Z.MODE_KANJI:return 8;default:throw new Error(`mode:${e}`)}else if(t<27)switch(e){case Z.MODE_NUMBER:return 12;case Z.MODE_ALPHA_NUM:return 11;case Z.MODE_8BIT_BYTE:return 16;case Z.MODE_KANJI:return 10;default:throw new Error(`mode:${e}`)}else if(t<41)switch(e){case Z.MODE_NUMBER:return 14;case Z.MODE_ALPHA_NUM:return 13;case Z.MODE_8BIT_BYTE:return 16;case Z.MODE_KANJI:return 12;default:throw new Error(`mode:${e}`)}else throw new Error(`type:${t}`)}static getLostPoint(e){const t=e.getModuleCount();let r=0;for(var i=0;i<t;i++)for(var o=0;o<t;o++){let l=0;const h=e.isDark(i,o);for(let m=-1;m<=1;m++)if(!(i+m<0||t<=i+m))for(let g=-1;g<=1;g++)o+g<0||t<=o+g||m==0&&g==0||h==e.isDark(i+m,o+g)&&l++;l>5&&(r+=3+l-5)}for(var i=0;i<t-1;i++)for(var o=0;o<t-1;o++){let m=0;e.isDark(i,o)&&m++,e.isDark(i+1,o)&&m++,e.isDark(i,o+1)&&m++,e.isDark(i+1,o+1)&&m++,(m==0||m==4)&&(r+=3)}for(var i=0;i<t;i++)for(var o=0;o<t-6;o++)e.isDark(i,o)&&!e.isDark(i,o+1)&&e.isDark(i,o+2)&&e.isDark(i,o+3)&&e.isDark(i,o+4)&&!e.isDark(i,o+5)&&e.isDark(i,o+6)&&(r+=40);for(var o=0;o<t;o++)for(var i=0;i<t-6;i++)e.isDark(i,o)&&!e.isDark(i+1,o)&&e.isDark(i+2,o)&&e.isDark(i+3,o)&&e.isDark(i+4,o)&&!e.isDark(i+5,o)&&e.isDark(i+6,o)&&(r+=40);let a=0;for(var o=0;o<t;o++)for(var i=0;i<t;i++)e.isDark(i,o)&&a++;return r+=Math.abs(100*a/t/t-50)/5*10,r}}L.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]];L.G15=1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0;L.G18=1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0;L.G15_MASK=1<<14|1<<12|1<<10|1<<4|1<<1;class H{static glog(e){if(e<1)throw new Error(`glog(${e})`);return H.LOG_TABLE[e]}static gexp(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return H.EXP_TABLE[e]}}H.EXP_TABLE=new Array(256);H.LOG_TABLE=new Array(256);H._constructor=function(){for(var n=0;n<8;n++)H.EXP_TABLE[n]=1<<n;for(var n=8;n<256;n++)H.EXP_TABLE[n]=H.EXP_TABLE[n-4]^H.EXP_TABLE[n-5]^H.EXP_TABLE[n-6]^H.EXP_TABLE[n-8];for(var n=0;n<255;n++)H.LOG_TABLE[H.EXP_TABLE[n]]=n}();class ut{constructor(e,t){if(e.length==null)throw new Error(`${e.length}/${t}`);let r=0;for(;r<e.length&&e[r]==0;)r++;this.num=new Array(e.length-r+t);for(let i=0;i<e.length-r;i++)this.num[i]=e[i+r]}get(e){return this.num[e]}getLength(){return this.num.length}multiply(e){const t=new Array(this.getLength()+e.getLength()-1);for(let r=0;r<this.getLength();r++)for(let i=0;i<e.getLength();i++)t[r+i]^=H.gexp(H.glog(this.get(r))+H.glog(e.get(i)));return new ut(t,0)}mod(e){if(this.getLength()-e.getLength()<0)return this;const t=H.glog(this.get(0))-H.glog(e.get(0)),r=new Array(this.getLength());for(var i=0;i<this.getLength();i++)r[i]=this.get(i);for(var i=0;i<e.getLength();i++)r[i]^=H.gexp(H.glog(e.get(i))+t);return new ut(r,0).mod(e)}}class ot{constructor(e,t){this.totalCount=e,this.dataCount=t}static getRSBlocks(e,t){const r=ot.getRsBlockTable(e,t);if(r==null)throw new Error(`bad rs block @ typeNumber:${e}/errorCorrectLevel:${t}`);const i=r.length/3,o=[];for(let a=0;a<i;a++){const c=r[a*3+0],l=r[a*3+1],h=r[a*3+2];for(let m=0;m<c;m++)o.push(new ot(l,h))}return o}static getRsBlockTable(e,t){switch(t){case V.L:return ot.RS_BLOCK_TABLE[(e-1)*4+0];case V.M:return ot.RS_BLOCK_TABLE[(e-1)*4+1];case V.Q:return ot.RS_BLOCK_TABLE[(e-1)*4+2];case V.H:return ot.RS_BLOCK_TABLE[(e-1)*4+3];default:return}}}ot.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];class Ie{constructor(){this.buffer=[],this.length=0}get(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)==1}put(e,t){for(let r=0;r<t;r++)this.putBit((e>>>t-r-1&1)==1)}getLengthInBits(){return this.length}putBit(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}}const et=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];var Le=100,X=256,Ht=X-1,lt=4,zt=16,Pt=1<<zt,jt=10,kt=10,Me=Pt>>kt,Fe=Pt<<jt-kt,Ne=X>>3,_t=6,Oe=1<<_t,Re=Ne*Oe,Ge=30,Kt=10,vt=1<<Kt,Xt=8,Jt=1<<Xt,Ue=Kt+Xt,ht=1<<Ue,Vt=499,Wt=491,Zt=487,Yt=503,$e=3*Yt;function He(n,e){var t,r,i,o,a;function c(){t=[],r=new Int32Array(256),i=new Int32Array(X),o=new Int32Array(X),a=new Int32Array(X>>3);var d,p;for(d=0;d<X;d++)p=(d<<lt+8)/X,t[d]=new Float64Array([p,p,p,0]),o[d]=Pt/X,i[d]=0}function l(){for(var d=0;d<X;d++)t[d][0]>>=lt,t[d][1]>>=lt,t[d][2]>>=lt,t[d][3]=d}function h(d,p,B,u,w){t[p][0]-=d*(t[p][0]-B)/vt,t[p][1]-=d*(t[p][1]-u)/vt,t[p][2]-=d*(t[p][2]-w)/vt}function m(d,p,B,u,w){for(var y=Math.abs(p-d),C=Math.min(p+d,X),x=p+1,T=p-1,M=1,s,F;x<C||T>y;)F=a[M++],x<C&&(s=t[x++],s[0]-=F*(s[0]-B)/ht,s[1]-=F*(s[1]-u)/ht,s[2]-=F*(s[2]-w)/ht),T>y&&(s=t[T--],s[0]-=F*(s[0]-B)/ht,s[1]-=F*(s[1]-u)/ht,s[2]-=F*(s[2]-w)/ht)}function g(d,p,B){var u=~(1<<31),w=u,y=-1,C=y,x,T,M,s,F;for(x=0;x<X;x++)T=t[x],M=Math.abs(T[0]-d)+Math.abs(T[1]-p)+Math.abs(T[2]-B),M<u&&(u=M,y=x),s=M-(i[x]>>zt-lt),s<w&&(w=s,C=x),F=o[x]>>kt,o[x]-=F,i[x]+=F<<jt;return o[y]+=Me,i[y]-=Fe,C}function f(){var d,p,B,u,w,y,C=0,x=0;for(d=0;d<X;d++){for(B=t[d],w=d,y=B[1],p=d+1;p<X;p++)u=t[p],u[1]<y&&(w=p,y=u[1]);if(u=t[w],d!=w&&(p=u[0],u[0]=B[0],B[0]=p,p=u[1],u[1]=B[1],B[1]=p,p=u[2],u[2]=B[2],B[2]=p,p=u[3],u[3]=B[3],B[3]=p),y!=C){for(r[C]=x+d>>1,p=C+1;p<y;p++)r[p]=d;C=y,x=d}}for(r[C]=x+Ht>>1,p=C+1;p<256;p++)r[p]=Ht}function D(d,p,B){for(var u,w,y,C=1e3,x=-1,T=r[p],M=T-1;T<X||M>=0;)T<X&&(w=t[T],y=w[1]-p,y>=C?T=X:(T++,y<0&&(y=-y),u=w[0]-d,u<0&&(u=-u),y+=u,y<C&&(u=w[2]-B,u<0&&(u=-u),y+=u,y<C&&(C=y,x=w[3])))),M>=0&&(w=t[M],y=p-w[1],y>=C?M=-1:(M--,y<0&&(y=-y),u=w[0]-d,u<0&&(u=-u),y+=u,y<C&&(u=w[2]-B,u<0&&(u=-u),y+=u,y<C&&(C=y,x=w[3]))));return x}function k(){var d,p=n.length,B=30+(e-1)/3,u=p/(3*e),w=~~(u/Le),y=vt,C=Re,x=C>>_t;for(x<=1&&(x=0),d=0;d<x;d++)a[d]=y*((x*x-d*d)*Jt/(x*x));var T;p<$e?(e=1,T=3):p%Vt!=0?T=3*Vt:p%Wt!=0?T=3*Wt:p%Zt!=0?T=3*Zt:T=3*Yt;var M,s,F,b,N=0;for(d=0;d<u;)if(M=(n[N]&255)<<lt,s=(n[N+1]&255)<<lt,F=(n[N+2]&255)<<lt,b=g(M,s,F),h(y,b,M,s,F),x!==0&&m(x,b,M,s,F),N+=T,N>=p&&(N-=p),d++,w===0&&(w=1),d%w==0)for(y-=y/B,C-=C/Ge,x=C>>_t,x<=1&&(x=0),b=0;b<x;b++)a[b]=y*((x*x-b*b)*Jt/(x*x))}function S(){c(),k(),l(),f()}this.buildColormap=S;function U(){for(var d=[],p=[],B=0;B<X;B++)p[t[B][3]]=B;for(var u=0,w=0;w<X;w++){var y=p[w];d[u++]=t[y][0],d[u++]=t[y][1],d[u++]=t[y][2]}return d}this.getColormap=U,this.lookupRGB=D}var qt=-1,mt=12,dt=5003,ze=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function je(n,e,t,r){var i=Math.max(2,r),o=new Uint8Array(256),a=new Int32Array(dt),c=new Int32Array(dt),l,h=0,m,g=0,f,D=!1,k,S,U,d,p,B;function u(b,N){o[m++]=b,m>=254&&T(N)}function w(b){y(dt),g=S+2,D=!0,F(S,b)}function y(b){for(var N=0;N<b;++N)a[N]=-1}function C(b,N){var v,ct,$,q,nt,z,Q;for(k=b,D=!1,B=k,f=M(B),S=1<<b-1,U=S+1,g=S+2,m=0,q=s(),Q=0,v=dt;v<65536;v*=2)++Q;Q=8-Q,z=dt,y(z),F(S,N);t:for(;(ct=s())!=qt;){if(v=(ct<<mt)+q,$=ct<<Q^q,a[$]===v){q=c[$];continue}else if(a[$]>=0){nt=z-$,$===0&&(nt=1);do if(($-=nt)<0&&($+=z),a[$]===v){q=c[$];continue t}while(a[$]>=0)}F(q,N),q=ct,g<1<<mt?(c[$]=g++,a[$]=v):w(N)}F(q,N),F(U,N)}function x(b){b.writeByte(i),d=n*e,p=0,C(i+1,b),b.writeByte(0)}function T(b){m>0&&(b.writeByte(m),b.writeBytes(o,0,m),m=0)}function M(b){return(1<<b)-1}function s(){if(d===0)return qt;--d;var b=t[p++];return b&255}function F(b,N){for(l&=ze[h],h>0?l|=b<<h:l=b,h+=B;h>=8;)u(l&255,N),l>>=8,h-=8;if((g>f||D)&&(D?(f=M(B=k),D=!1):(++B,B==mt?f=1<<mt:f=M(B))),b==U){for(;h>0;)u(l&255,N),l>>=8,h-=8;T(N)}}this.encode=x}function W(){this.page=-1,this.pages=[],this.newPage()}W.pageSize=4096;W.charMap={};for(var yt=0;yt<256;yt++)W.charMap[yt]=String.fromCharCode(yt);W.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(W.pageSize),this.cursor=0};W.prototype.getData=function(){for(var n="",e=0;e<this.pages.length;e++)for(var t=0;t<W.pageSize;t++)n+=W.charMap[this.pages[e][t]];return n};W.prototype.toFlattenUint8Array=function(){const n=[];for(var e=0;e<this.pages.length;e++)if(e===this.pages.length-1){const r=Uint8Array.from(this.pages[e].slice(0,this.cursor));n.push(r)}else n.push(this.pages[e]);const t=new Uint8Array(n.reduce((r,i)=>r+i.length,0));return n.reduce((r,i)=>(t.set(i,r),r+i.length),0),t};W.prototype.writeByte=function(n){this.cursor>=W.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=n};W.prototype.writeUTFBytes=function(n){for(var e=n.length,t=0;t<e;t++)this.writeByte(n.charCodeAt(t))};W.prototype.writeBytes=function(n,e,t){for(var r=t||n.length,i=e||0;i<r;i++)this.writeByte(n[i])};function O(n,e){this.width=~~n,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new W}O.prototype.setDelay=function(n){this.delay=Math.round(n/10)};O.prototype.setFrameRate=function(n){this.delay=Math.round(100/n)};O.prototype.setDispose=function(n){n>=0&&(this.dispose=n)};O.prototype.setRepeat=function(n){this.repeat=n};O.prototype.setTransparent=function(n){this.transparent=n};O.prototype.addFrame=function(n){this.image=n,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),this.globalPalette===!0&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeHeader(),this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),!this.firstFrame&&!this.globalPalette&&this.writePalette(),this.writePixels(),this.firstFrame=!1};O.prototype.finish=function(){this.out.writeByte(59)};O.prototype.setQuality=function(n){n<1&&(n=1),this.sample=n};O.prototype.setDither=function(n){n===!0&&(n="FloydSteinberg"),this.dither=n};O.prototype.setGlobalPalette=function(n){this.globalPalette=n};O.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette};O.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")};O.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new He(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),this.dither.match(/-serpentine/)!==null):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,this.transparent!==null&&(this.transIndex=this.findClosest(this.transparent,!0))};O.prototype.indexPixels=function(n){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);for(var t=0,r=0;r<e;r++){var i=this.findClosestRGB(this.pixels[t++]&255,this.pixels[t++]&255,this.pixels[t++]&255);this.usedEntry[i]=!0,this.indexedPixels[r]=i}};O.prototype.ditherPixels=function(n,e){var t={FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[2/8,1,1]],FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]};if(!n||!t[n])throw"Unknown dithering kernel: "+n;var r=t[n],i=0,o=this.height,a=this.width,c=this.pixels,l=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var h=0;h<o;h++){e&&(l=l*-1);for(var m=l==1?0:a-1,g=l==1?a:0;m!==g;m+=l){i=h*a+m;var f=i*3,D=c[f],k=c[f+1],S=c[f+2];f=this.findClosestRGB(D,k,S),this.usedEntry[f]=!0,this.indexedPixels[i]=f,f*=3;for(var U=this.colorTab[f],d=this.colorTab[f+1],p=this.colorTab[f+2],B=D-U,u=k-d,w=S-p,y=l==1?0:r.length-1,C=l==1?r.length:0;y!==C;y+=l){var x=r[y][1],T=r[y][2];if(x+m>=0&&x+m<a&&T+h>=0&&T+h<o){var M=r[y][0];f=i+x+T*a,f*=3,c[f]=Math.max(0,Math.min(255,c[f]+B*M)),c[f+1]=Math.max(0,Math.min(255,c[f+1]+u*M)),c[f+2]=Math.max(0,Math.min(255,c[f+2]+w*M))}}}}};O.prototype.findClosest=function(n,e){return this.findClosestRGB((n&16711680)>>16,(n&65280)>>8,n&255,e)};O.prototype.findClosestRGB=function(n,e,t,r){if(this.colorTab===null)return-1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(n,e,t);for(var i=0,o=256*256*256,a=this.colorTab.length,c=0,l=0;c<a;l++){var h=n-(this.colorTab[c++]&255),m=e-(this.colorTab[c++]&255),g=t-(this.colorTab[c++]&255),f=h*h+m*m+g*g;(!r||this.usedEntry[l])&&f<o&&(o=f,i=l)}return i};O.prototype.getImagePixels=function(){var n=this.width,e=this.height;this.pixels=new Uint8Array(n*e*3);for(var t=this.image,r=0,i=0,o=0;o<e;o++)for(var a=0;a<n;a++)this.pixels[i++]=t[r++],this.pixels[i++]=t[r++],this.pixels[i++]=t[r++],r++};O.prototype.writeGraphicCtrlExt=function(){this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4);var n,e;this.transparent===null?(n=0,e=0):(n=1,e=2),this.dispose>=0&&(e=this.dispose&7),e<<=2,this.out.writeByte(0|e|0|n),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)};O.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|0|0|0|this.palSize)};O.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(128|112|0|this.palSize),this.out.writeByte(0),this.out.writeByte(0)};O.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)};O.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var n=3*256-this.colorTab.length,e=0;e<n;e++)this.out.writeByte(0)};O.prototype.writeShort=function(n){this.out.writeByte(n&255),this.out.writeByte(n>>8&255)};O.prototype.writePixels=function(){var n=new je(this.width,this.height,this.indexedPixels,this.colorDepth);n.encode(this.out)};O.prototype.stream=function(){return this.out};var Ke=globalThis&&globalThis.__awaiter||function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function c(m){try{h(r.next(m))}catch(g){a(g)}}function l(m){try{h(r.throw(m))}catch(g){a(g)}}function h(m){m.done?o(m.value):i(m.value).then(c,l)}h((r=r.apply(n,e||[])).next())})};const bt=.4;function Qt(n){if(!n)return;function e(t){t.onload=null,t.onerror=null}return new Promise(function(t,r){if(n.slice(0,4)=="data"){let o=new Image;o.onload=function(){t(o),e(o)},o.onerror=function(){r("Image load error"),e(o)},o.src=n;return}let i=new Image;i.setAttribute("crossOrigin","Anonymous"),i.onload=function(){t(i)},i.onerror=function(){r("Image load error")},i.src=n})}class I{constructor(e){const t=Object.assign({},e);if(Object.keys(I.defaultOptions).forEach(r=>{r in t||Object.defineProperty(t,r,{value:I.defaultOptions[r],enumerable:!0,writable:!0})}),t.components?typeof t.components=="object"&&Object.keys(I.defaultComponentOptions).forEach(r=>{r in t.components?Object.defineProperty(t.components,r,{value:Object.assign(Object.assign({},I.defaultComponentOptions[r]),t.components[r]),enumerable:!0,writable:!0}):Object.defineProperty(t.components,r,{value:I.defaultComponentOptions[r],enumerable:!0,writable:!0})}):t.components=I.defaultComponentOptions,t.dotScale!==null&&t.dotScale!==void 0){if(t.dotScale<=0||t.dotScale>1)throw new Error("dotScale should be in range (0, 1].");t.components.data.scale=t.dotScale,t.components.timing.scale=t.dotScale,t.components.alignment.scale=t.dotScale}this.options=t,this.canvas=rt(e.size,e.size),this.canvasContext=this.canvas.getContext("2d"),this.qrCode=new st(-1,this.options.correctLevel),Number.isInteger(this.options.maskPattern)&&(this.qrCode.maskPattern=this.options.maskPattern),Number.isInteger(this.options.version)&&(this.qrCode.typeNumber=this.options.version),this.qrCode.addData(this.options.text),this.qrCode.make()}draw(){return new Promise(e=>this._draw().then(e))}_clear(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)}static _prepareRoundedCornerClip(e,t,r,i,o,a){e.beginPath(),e.moveTo(t,r),e.arcTo(t+i,r,t+i,r+o,a),e.arcTo(t+i,r+o,t,r+o,a),e.arcTo(t,r+o,t,r,a),e.arcTo(t,r,t+i,r,a),e.closePath()}static _getAverageRGB(e){const t=5,r={r:0,g:0,b:0};let i,o,a=-4;const c={r:0,g:0,b:0};let l=0;o=e.naturalHeight||e.height,i=e.naturalWidth||e.width;const m=rt(i,o).getContext("2d");if(!m)return r;m.drawImage(e,0,0);let g;try{g=m.getImageData(0,0,i,o)}catch{return r}for(;(a+=t*4)<g.data.length;)g.data[a]>200||g.data[a+1]>200||g.data[a+2]>200||(++l,c.r+=g.data[a],c.g+=g.data[a+1],c.b+=g.data[a+2]);return c.r=~~(c.r/l),c.g=~~(c.g/l),c.b=~~(c.b/l),c}static _drawDot(e,t,r,i,o=0,a=1){e.fillRect((t+o)*i,(r+o)*i,a*i,a*i)}static _drawAlignProtector(e,t,r,i){e.clearRect((t-2)*i,(r-2)*i,5*i,5*i),e.fillRect((t-2)*i,(r-2)*i,5*i,5*i)}static _drawAlign(e,t,r,i,o=0,a=1,c,l){const h=e.fillStyle;e.fillStyle=c,new Array(4).fill(0).map((m,g)=>{I._drawDot(e,t-2+g,r-2,i,o,a),I._drawDot(e,t+2,r-2+g,i,o,a),I._drawDot(e,t+2-g,r+2,i,o,a),I._drawDot(e,t-2,r+2-g,i,o,a)}),I._drawDot(e,t,r,i,o,a),l||(e.fillStyle="rgba(255, 255, 255, 0.6)",new Array(2).fill(0).map((m,g)=>{I._drawDot(e,t-1+g,r-1,i,o,a),I._drawDot(e,t+1,r-1+g,i,o,a),I._drawDot(e,t+1-g,r+1,i,o,a),I._drawDot(e,t-1,r+1-g,i,o,a)})),e.fillStyle=h}_draw(){var e,t,r,i,o,a,c,l,h,m,g,f,D,k,S,U,d,p,B;return Ke(this,void 0,void 0,function*(){const u=(e=this.qrCode)===null||e===void 0?void 0:e.moduleCount,w=this.options.size;let y=this.options.margin;(y<0||y*2>=w)&&(y=0);const C=Math.ceil(y),x=w-2*y,T=this.options.whiteMargin,M=this.options.backgroundDimming,s=Math.ceil(x/u),F=s*u,b=F+2*C,N=rt(b,b),v=N.getContext("2d");this._clear(),v.save(),v.translate(C,C);const ct=rt(b,b),$=ct.getContext("2d");let q=null,nt=[];if(this.options.gifBackground){const P=ke(this.options.gifBackground);if(q=P,nt=De(P,!0),this.options.autoColor){let _=0,E=0,A=0,K=0;for(let R=0;R<nt[0].colorTable.length;R++){const G=nt[0].colorTable[R];G[0]>200||G[1]>200||G[2]>200||G[0]===0&&G[1]===0&&G[2]===0||(K++,_+=G[0],E+=G[1],A+=G[2])}_=~~(_/K),E=~~(E/K),A=~~(A/K),this.options.colorDark=`rgb(${_},${E},${A})`}}else if(this.options.backgroundImage){const P=yield Qt(this.options.backgroundImage);if(this.options.autoColor){const _=I._getAverageRGB(P);this.options.colorDark=`rgb(${_.r},${_.g},${_.b})`}$.drawImage(P,0,0,P.width,P.height,0,0,b,b),$.rect(0,0,b,b),$.fillStyle=M,$.fill()}else $.rect(0,0,b,b),$.fillStyle=this.options.colorLight,$.fill();const z=L.getPatternPosition(this.qrCode.typeNumber),Q=((r=(t=this.options.components)===null||t===void 0?void 0:t.data)===null||r===void 0?void 0:r.scale)||bt,Tt=(1-Q)*.5;for(let P=0;P<u;P++)for(let _=0;_<u;_++){const E=this.qrCode.isDark(P,_),A=_<8&&(P<8||P>=u-8)||_>=u-8&&P<8,K=P==6&&_>=8&&_<=u-8||_==6&&P>=8&&P<=u-8;let R=A||K;for(let J=1;J<z.length-1;J++)R=R||P>=z[J]-2&&P<=z[J]+2&&_>=z[J]-2&&_<=z[J]+2;const G=_*s+(R?0:Tt*s),tt=P*s+(R?0:Tt*s);if(v.strokeStyle=E?this.options.colorDark:this.options.colorLight,v.lineWidth=.5,v.fillStyle=E?this.options.colorDark:this.options.colorLight,z.length===0)R||v.fillRect(G,tt,(R?1:Q)*s,(R?1:Q)*s);else{const J=_<u-4&&_>=u-4-5&&P<u-4&&P>=u-4-5;!R&&!J&&v.fillRect(G,tt,(R?1:Q)*s,(R?1:Q)*s)}}const Y=z[z.length-1],ee=this.options.colorLight;if(v.fillStyle=ee,v.fillRect(0,0,8*s,8*s),v.fillRect(0,(u-8)*s,8*s,8*s),v.fillRect((u-8)*s,0,8*s,8*s),((o=(i=this.options.components)===null||i===void 0?void 0:i.timing)===null||o===void 0?void 0:o.protectors)&&(v.fillRect(8*s,6*s,(u-8-8)*s,s),v.fillRect(6*s,8*s,s,(u-8-8)*s)),((c=(a=this.options.components)===null||a===void 0?void 0:a.cornerAlignment)===null||c===void 0?void 0:c.protectors)&&I._drawAlignProtector(v,Y,Y,s),(h=(l=this.options.components)===null||l===void 0?void 0:l.alignment)===null||h===void 0?void 0:h.protectors)for(let P=0;P<z.length;P++)for(let _=0;_<z.length;_++){const E=z[_],A=z[P];if(!(E===6&&(A===6||A===Y))){if(A===6&&(E===6||E===Y))continue;if(E===Y&&A===Y)continue;I._drawAlignProtector(v,E,A,s)}}v.fillStyle=this.options.colorDark,v.fillRect(0,0,7*s,s),v.fillRect((u-7)*s,0,7*s,s),v.fillRect(0,6*s,7*s,s),v.fillRect((u-7)*s,6*s,7*s,s),v.fillRect(0,(u-7)*s,7*s,s),v.fillRect(0,(u-7+6)*s,7*s,s),v.fillRect(0,0,s,7*s),v.fillRect(6*s,0,s,7*s),v.fillRect((u-7)*s,0,s,7*s),v.fillRect((u-7+6)*s,0,s,7*s),v.fillRect(0,(u-7)*s,s,7*s),v.fillRect(6*s,(u-7)*s,s,7*s),v.fillRect(2*s,2*s,3*s,3*s),v.fillRect((u-7+2)*s,2*s,3*s,3*s),v.fillRect(2*s,(u-7+2)*s,3*s,3*s);const wt=((g=(m=this.options.components)===null||m===void 0?void 0:m.timing)===null||g===void 0?void 0:g.scale)||bt,Dt=(1-wt)*.5;for(let P=0;P<u-8;P+=2)I._drawDot(v,8+P,6,s,Dt,wt),I._drawDot(v,6,8+P,s,Dt,wt);const At=((D=(f=this.options.components)===null||f===void 0?void 0:f.cornerAlignment)===null||D===void 0?void 0:D.scale)||bt,re=(1-At)*.5;I._drawAlign(v,Y,Y,s,re,At,this.options.colorDark,((S=(k=this.options.components)===null||k===void 0?void 0:k.cornerAlignment)===null||S===void 0?void 0:S.protectors)||!1);const Et=((d=(U=this.options.components)===null||U===void 0?void 0:U.alignment)===null||d===void 0?void 0:d.scale)||bt,ie=(1-Et)*.5;for(let P=0;P<z.length;P++)for(let _=0;_<z.length;_++){const E=z[_],A=z[P];if(!(E===6&&(A===6||A===Y))){if(A===6&&(E===6||E===Y))continue;if(E===Y&&A===Y)continue;I._drawAlign(v,E,A,s,ie,Et,this.options.colorDark,((B=(p=this.options.components)===null||p===void 0?void 0:p.alignment)===null||B===void 0?void 0:B.protectors)||!1)}}if(T&&(v.fillStyle=this.options.backgroundColor,v.fillRect(-C,-C,b,C),v.fillRect(-C,F,b,C),v.fillRect(F,-C,C,b),v.fillRect(-C,-C,C,b)),this.options.logoImage){const P=yield Qt(this.options.logoImage);let _=this.options.logoScale,E=this.options.logoMargin,A=this.options.logoCornerRadius;(_<=0||_>=1)&&(_=.2),E<0&&(E=0),A<0&&(A=0);const K=F*_,R=.5*(b-K),G=R;v.restore(),v.fillStyle=this.options.logoBackgroundColor,v.save(),I._prepareRoundedCornerClip(v,R-E,G-E,K+2*E,K+2*E,A+E),v.clip();const tt=v.globalCompositeOperation;v.globalCompositeOperation="destination-out",v.fill(),v.globalCompositeOperation=tt,v.restore(),v.save(),I._prepareRoundedCornerClip(v,R,G,K,K,A),v.clip(),v.drawImage(P,R,G,K,K),v.restore(),v.save(),v.translate(C,C)}if(q){let P,_,E,A,K,R;if(nt.forEach(function(G){P||(P=new O(w,w),P.setDelay(G.delay),P.setRepeat(0));const{width:tt,height:J}=G.dims;_||(_=rt(tt,J),E=_.getContext("2d"),E.rect(0,0,_.width,_.height),E.fillStyle="#ffffff",E.fill()),(!A||!R||tt!==A.width||J!==A.height)&&(A=rt(tt,J),K=A.getContext("2d"),R=K.createImageData(tt,J)),R.data.set(G.patch),K.putImageData(R,0,0),E.drawImage(A,G.dims.left,G.dims.top);const gt=rt(b,b),ft=gt.getContext("2d");ft.drawImage(_,0,0,b,b),ft.rect(0,0,b,b),ft.fillStyle=M,ft.fill(),ft.drawImage(N,0,0,b,b);const Bt=rt(w,w),St=Bt.getContext("2d");St.drawImage(gt,0,0,w,w),P.addFrame(St.getImageData(0,0,Bt.width,Bt.height).data)}),!P)throw new Error("No frames.");if(P.finish(),te(this.canvas)){const tt=P.stream().toFlattenUint8Array().reduce((J,gt)=>J+String.fromCharCode(gt),"");return Promise.resolve(`data:image/gif;base64,${window.btoa(tt)}`)}return Promise.resolve(Buffer.from(P.stream().toFlattenUint8Array()))}else{$.drawImage(N,0,0,b,b),v.drawImage(ct,-C,-C,b,b);const P=rt(w,w);return P.getContext("2d").drawImage(N,0,0,w,w),this.canvas=P,te(this.canvas)?Promise.resolve(this.canvas.toDataURL()):Promise.resolve(this.canvas.toBuffer())}})}}I.CorrectLevel=V;I.defaultComponentOptions={data:{scale:.4},timing:{scale:.5,protectors:!1},alignment:{scale:.5,protectors:!1},cornerAlignment:{scale:.5,protectors:!0}};I.defaultOptions={text:"",size:400,margin:20,colorDark:"#000000",colorLight:"rgba(255, 255, 255, 0.6)",correctLevel:V.M,backgroundImage:void 0,backgroundDimming:"rgba(0,0,0,0)",logoImage:void 0,logoScale:.2,logoMargin:4,logoCornerRadius:8,whiteMargin:!0,components:I.defaultComponentOptions,autoColor:!0,logoBackgroundColor:"#ffffff",backgroundColor:"#ffffff"};function te(n){try{return n instanceof HTMLElement}catch{return typeof n=="object"&&n.nodeType===1&&typeof n.style=="object"&&typeof n.ownerDocument=="object"}}const Xe={props:{text:{type:String,required:!0},qid:{type:String},correctLevel:{type:Number,default:1},size:{type:Number,default:200},margin:{type:Number,default:20},colorDark:{type:String,default:"#000000"},colorLight:{type:String,default:"#FFFFFF"},bgSrc:{type:String,default:void 0},background:{type:String,default:"rgba(0,0,0,0)"},backgroundDimming:{type:String,default:"rgba(0,0,0,0)"},logoSrc:{type:String,default:void 0},logoBackgroundColor:{type:String,default:"rgba(255,255,255,1)"},gifBgSrc:{type:String,default:void 0},logoScale:{type:Number,default:.2},logoMargin:{type:Number,default:0},logoCornerRadius:{type:Number,default:8},whiteMargin:{type:[Boolean,String],default:!0},dotScale:{type:Number,default:1},autoColor:{type:[Boolean,String],default:!0},binarize:{type:[Boolean,String],default:!1},binarizeThreshold:{type:Number,default:128},callback:{type:Function,default:function(){}},bindElement:{type:Boolean,default:!0},backgroundColor:{type:String,default:"#FFFFFF"},components:{default:function(){return{data:{scale:1},timing:{scale:1,protectors:!1},alignment:{scale:1,protectors:!1},cornerAlignment:{scale:1,protectors:!0}}}}},name:"vue-qr",data(){return{imgUrl:""}},watch:{$props:{deep:!0,handler(){this.main()}}},mounted(){this.main()},methods:{async main(){if(this.gifBgSrc){const t=await ue(this.gifBgSrc),r=this.logoSrc;this.render(void 0,r,t);return}const n=this.bgSrc,e=this.logoSrc;this.render(n,e)},async render(n,e,t){const r=this;new I({gifBackground:t,text:r.text,size:r.size,margin:r.margin,colorDark:r.colorDark,colorLight:r.colorLight,backgroundColor:r.backgroundColor,backgroundImage:n,backgroundDimming:r.backgroundDimming,logoImage:e,logoScale:r.logoScale,logoBackgroundColor:r.logoBackgroundColor,correctLevel:r.correctLevel,logoMargin:r.logoMargin,logoCornerRadius:r.logoCornerRadius,whiteMargin:Ct(r.whiteMargin),dotScale:r.dotScale,autoColor:Ct(r.autoColor),binarize:Ct(r.binarize),binarizeThreshold:r.binarizeThreshold,components:r.components}).draw().then(i=>{this.imgUrl=i,r.callback&&r.callback(i,r.qid)})}}},Je=["src"];function Ve(n,e,t,r,i,o){return t.bindElement?(It(),ne("img",{key:0,style:{display:"inline-block"},src:i.imgUrl},null,8,Je)):ae("",!0)}var We=Nt(Xe,[["render",Ve]]);const Ze={class:"codeBox"},Ye={class:"imgBox"},qe={setup(n){const e=Lt(!0),t=Lt("xxx");se();function r(){e.value=!1}return(i,o)=>{const a=Mt("van-image"),c=Mt("van-popup");return It(),le(c,{show:e.value,"onUpdate:show":o[0]||(o[0]=l=>e.value=l),"close-on-click-overlay":!1,class:"popupMark"},{default:ce(()=>[Ft("div",Ze,[Ft("div",Ye,[xt(a,{class:"codeImg",fit:"contain",src:"/src/assets/imgs/qrcode.png"}),xt(We,{class:"qrCode",logoSrc:t.value.value,text:"http://www.baidu.com",size:176,margin:0},null,8,["logoSrc"]),xt(a,{onClick:r,class:"closeImg",fit:"contain",src:"/src/assets/imgs/close.png"})])])]),_:1},8,["show"])}}};var er=Nt(qe,[["__scopeId","data-v-4b56ff08"]]);export{er as default};
